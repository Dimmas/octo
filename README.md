# octo
full text file search lan system

1. Octo (сокращ. от octopus) - система полнотекстового поиска внутри документов хостов, объединенных в локальную сеть.
  Предназначена для поиска документов в локальных сетях по ключевому слову/поисковому запросу.

  Программа является по сути средством автоматизации утилиты recoll, входящей в базовый пакет многих дистрибутивов Linux.
  Т.к. recoll предварительно индексирует документы на хостах, поиск по всей сети, как правило, занимает не больше минуты.
  Программа позволяет работать с пулом сетей. Результаты поиска скидываются в базу данных, где просмотреть их можно любым удобным sql-браузером, а также сделать экспорт в любом удобном формате.

  Алгоритм работы сделующий:

  #python3 net_octopus.py 

  Octo в несколько потоков обращается к хостам локальной сети по ssh (22 порт), авторизуется на них под локальным админом и выполняет следующие действия на выбор:

      1. Установка octo на хосты

      2. Поиск на хостах

      3. Индексирование хостов

2. Варианты развертывания Octo:

  2.1. Контейнер docker - самый простой способ деплоя. В каталоге проекта лежит dockerfile, перед использованием которого следует указать следующие настройки:
  
  В файле net_octopus.py прописать сеть (вместо 0.0.0 указать первые три октета своей сети), диапазон ip-адресов(range(2,16) - вместо 2 и 16 указать свой диапазон), указать локального админа хоста

      lan_list = [['0.0.0.', range(2, 16), 'local_host_admin', 'pass']]  # list of lan with ip_range, user_name, user_pass

  Пример для одной  сети:

    lan_list = [['10.10.1.', range(2, 254), 'almin', 'admin_password']]  # list of lan with ip_range, user_name, user_pass

  Пример для пула сетей:

    lan_list = [

        ['10.10.1.', range(2, 254), 'admin1', 'pass1'],

        ['10.20.2.', range(2, 128), 'admin2', 'pass2'],

        ...

        ...

        ...

        ]

   Т.к. результаты работы скрипта помещаются в базу данных, необходимо ее тоже развернуть из DockerHub. Настройки БД приведены в п. 3.
 
2.2. Развертывание Octo без использования docker потребует предварительной установки на машину, с которой будет осуществляться сканирование хостов, следующих  зависимостей:
      
      paramiko,

      SQLAlchemy,

      psycopg2-binary
      
      Команда для установки: #apt-get install paramiko, SQLAlchemy, psycopg2-binary

3. Настройки подключения к СУБД:
  
    В файле DBoctopus.py в строке engine = create_engine('postgresql://postgres:passwd@localhost:5432/postgres', pool_size=20) укажите свою СУБД и пользователя.
    Т.к. octo использует SQLAlchemy, Вы можете использовать удобную для Вас СУБД. В примере используется Postgres.
    
    Затем необходимо проинициализировать БД командой: #python3 DBoctopus.py , выбрать п.1.
    
4. Настройка octo на хостах
  
    Для того, чтобы утилита Recoll могла смотреть текстовые файлы doc и docx на хосте должна быть установлена утилита 'antiword', для odt-документов - 'python-libxslt1'.

    К счастью octo настраивает хосты автоматически. Для того, чтобы настройка прошла успешно, достаточно, чтобы хосты имели доступ к репозитарию ПО и в нем имелись указанные пакеты.

    На машине, с которой будет проводиться сканирование, должны иметься следующие файлы конфигурации recoll и cron:

      /root/.recoll/recoll.conf

      /etc/crontab

      Эти файлы будут экспортированы на хосты для настройки recoll и планировщика заданий.

      Для запуска настройки хостов для работы с octo выполните: # python3 net_octopus.py install
    
5. Индексирование хостов
  Перед тем как что-либо искать на хостах, требуется проиндексировать их содержимое утилитой recoll:

    Для запуска индексирования выполните: # python3 net_octopus.py index, или    # python3 net_octopus.py , а затем пункт 4

6. Поиск документов, удовлетворяющих поисковому запросу

    Поиск осуществляется по вхождению ключевого слова в теле каждого документа каждого сетевого хоста. результат помещается в БД. Ищутся все словоформы поискового запроса.

      Для запуска поиска выполните: # python3 net_octopus.py search 'поисковый запрос', или    # python3 net_octopus.py , а затем пункт 2
    
    
  Полезное:
  
    Файл net_octopus.py является инструкциями для Net-helper.py, который в свою очередь предназначен для управления хостами сети. Net-helper может ставить/удалять пакеты на хосты Вашей сети (посредством apt), экспортировать с/ импортировать на машину, на которой запущен octo, файлы с/на хосты в сети, а также выполнять произвольные команды (linux bash) на хостах сети.
  
  Перспективы развития:
  
   Программа писалась мной в рамках освоения Python и в целях автоматизации поиска документов определенного содержания сетях организации.
   Возможно в будущем я прикручу нейронную сеть для классификации найденных документов (речь идет о бинарном классификаторе)
    
    
